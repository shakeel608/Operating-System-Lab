<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README_tests</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h2 id="introduction">Introduction</h2>
<p>The files allocX.in, included in the directory <strong>tests</strong>, are examples of inputs for the program <strong>mem_shell</strong>. Do not hesitate to write your own scenarios. A short description of each of these files is given below.</p>
<p>The program <strong>mem_shell_sim</strong> included in the directory <strong>./bin</strong> generates the expected trace for a given input and thus allows you to check whether your program works as expected.</p>
<p>Note that the program <strong>mem_shell</strong> can also be run interactively with:</p>
<pre><code>    ./mem_shell</code></pre>
<p>then type <code>h</code> to get some help.</p>
<h2 id="syntax">Syntax</h2>
<p>The syntax of “.in” files is simple. The only rule is to write 1 command per line. Three commands are available.</p>
<ul>
<li><strong>aXX</strong>: asks for the allocation of a block of size XX.</li>
<li><strong>fY</strong>: asks to free the block allocated by the Y-th call to malloc</li>
<li><strong>q</strong>: tells the program to terminate</li>
</ul>
<h2 id="running-a-test">Running a test</h2>
<p>To test if a scenario works as expected, use the provided Makefile and simply run (for the case of alloc1.in):</p>
<pre><code>make -B tests/alloc1.test</code></pre>
<h2 id="configuring-a-test">Configuring a test</h2>
<p>Note that the file <strong>Makefile.config</strong> includes the definition of the main parameters of the allocator. You can change the value of these parameters to test your allocator under different conditions.</p>
<h2 id="specification-of-the-expected-output">Specification of the expected output</h2>
<p>The program <strong>mem_shell_sim</strong> makes a few assumption when generating the trace for a test case. <strong>You have to follow the same rules in your implementation for it to be considered as correct</strong>.</p>
<ul>
<li>Calling memory_alloc() with a size of 0 returns a valid pointer that can later be freed.</li>
<li>If memory_alloc() does not manage to allocate a block, the program terminates with a call to exit(0).</li>
<li>Trace functions are called appropriately.</li>
<li>The list of free blocks is ordered according to increasing memory addresses.</li>
<li>With the <em>Next fit</em> policy, if a block immediately preceding the block to start searching from for the next allocation, is freed, the two blocks are coalesced and the starting block for the next search becomes the new coalesced block.</li>
</ul>
<p><em>If you followed all these rules, and mem_shell_sim generates a different trace from the one generated by your allocator, but you are sure your allocator is correct, please don’t hesitate to send an email to the teaching staff with information about your problematic scenario. There can always be errors in the simulation.</em></p>
<h2 id="description-of-the-provided-scenarios">Description of the provided scenarios</h2>
<h3 id="alloc1.in">alloc1.in:</h3>
<p>A simple sequence of memory allocations that should be handled by fast pool 0.</p>
<h3 id="alloc2.in">alloc2.in:</h3>
<p>A sequence of allocations that should be handled by the 3 fast pools.</p>
<h3 id="alloc3.in">alloc3.in:</h3>
<p>A sequence of allocation and free calls that should be handled by fast pool 0.</p>
<h3 id="alloc4.in">alloc4.in:</h3>
<p>A sequence of allocation and free calls that should be handled by the 3 fast pools.</p>
<h3 id="alloc5.in">alloc5.in:</h3>
<p>A sequence of allocations that should be handled by the standard pool.</p>
<h3 id="alloc6.in">alloc6.in</h3>
<p>A sequence of allocation and free calls that should be handled by the standard pool.</p>
<h3 id="alloc7.in">alloc7.in</h3>
<p>A more complex sequence of allocation and free calls that should be handled by the standard pool.</p>
<h3 id="alloc8.in">alloc8.in</h3>
<p>An even more complex sequence of allocation and free calls that should be handled by the standard pool.</p>
<h2 id="a-few-more-tests">A few more tests</h2>
<p>The provided Makefile also allows you to test whether your memory allocator works with standard programs. The tests that can be run are:</p>
<pre><code>  make test_ls
  make test_ps</code></pre>
</body>
</html>
